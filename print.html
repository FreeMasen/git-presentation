<!DOCTYPE HTML>
<html lang="en" class="sidebar-visible no-js light">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>git-workflow</title>
        <meta name="robots" content="noindex" />
        <!-- Custom HTML head -->
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

        <link rel="icon" href="favicon.svg">
        <link rel="shortcut icon" href="favicon.png">
        <link rel="stylesheet" href="css/variables.css">
        <link rel="stylesheet" href="css/general.css">
        <link rel="stylesheet" href="css/chrome.css">
        <link rel="stylesheet" href="css/print.css" media="print">
        <!-- Fonts -->
        <link rel="stylesheet" href="FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="fonts/fonts.css">
        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="highlight.css">
        <link rel="stylesheet" href="tomorrow-night.css">
        <link rel="stylesheet" href="ayu-highlight.css">

        <!-- Custom theme stylesheets -->
    </head>
    <body>
        <!-- Provide site root to javascript -->
        <script type="text/javascript">
            var path_to_root = "";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script type="text/javascript">
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script type="text/javascript">
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('no-js')
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add('js');
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script type="text/javascript">
            var html = document.querySelector('html');
            var sidebar = 'hidden';
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded "><a href="overview.html"><strong aria-hidden="true">1.</strong> Overview</a></li><li class="chapter-item expanded "><a href="fixup.html"><strong aria-hidden="true">2.</strong> fixup</a></li><li class="chapter-item expanded "><a href="rebase.html"><strong aria-hidden="true">3.</strong> rebase</a></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky bordered">
                    <div class="left-buttons">
                        <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </button>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light (default)</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">git-workflow</h1>

                    <div class="right-buttons">
                        <a href="print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>
                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>
                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script type="text/javascript">
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="overview"><a class="header" href="#overview">Overview</a></h1>
<ul>
<li>Multiple commits makes reviewing easier</li>
<li>Fixups make this easier</li>
<li>Rebasing can be painful</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="fixups"><a class="header" href="#fixups">Fixups</a></h1>
<p>In a PR review, some feedback about Commit Two requires making some changes. After the changes have been made, we can fixup Commit Two to avoid extra commits. First we need to grab the reference.</p>
<pre><code class="language-shell">git log
commit fa11fa11fa11fa11fa11fa11fa11fa11fa11fa11
Author: Robert Masen &lt;r.f.masen@gmail.com&gt;
Date:   Mon Jan 29 15:09:29 2024 -0600

    Commit Three

# copy this commit has (or first 7)
commit facefacefacefacefacefacefacefacefaceface
Author: Robert Masen &lt;r.f.masen@gmail.com&gt;
Date:   Mon Jan 29 09:44:37 2024 -0600

    Commit Two

commit cafecafecafecafecafecafecafecafecafecafe
Author: Robert Masen &lt;r.f.masen@gmail.com&gt;
Date:   Fri Jan 26 15:09:01 2024 -0600

    Commit One
</code></pre>
<p>Now we can use the --fixup flag to update an existing commit</p>
<pre><code class="language-shell">git commit --fixup a9d3dea #updating Commit Two
</code></pre>
<p>Just to confirm here is the new log</p>
<pre><code class="language-shell">git log
# the commit message is prefixed with fixup! which is how git figures
# out where to merge this in the next step
commit beeffeedbeeffeedbeeffeedbeeffeedbeeffeed
Author: Robert Masen &lt;r.f.masen@gmail.com&gt;
Date:   Mon Jan 29 15:09:29 2024 -0600

    fixup! Commit Two

commit fa11fa11fa11fa11fa11fa11fa11fa11fa11fa11
Author: Robert Masen &lt;r.f.masen@gmail.com&gt;
Date:   Mon Jan 29 15:09:29 2024 -0600

    Commit Three

commit facefacefacefacefacefacefacefacefaceface
Author: Robert Masen &lt;r.f.masen@gmail.com&gt;
Date:   Mon Jan 29 09:44:37 2024 -0600

    Commit Two

commit cafecafecafecafecafecafecafecafecafecafe
Author: Robert Masen &lt;r.f.masen@gmail.com&gt;
Date:   Fri Jan 26 15:09:01 2024 -0600

    Commit One
</code></pre>
<p>Now, we can perform a rebase to combine our fixup commit with Commit Two</p>
<pre><code class="language-shell"># we can use ~1 to mean the commit before this commit
git rebase -i --autosquash a9d3dea~1

This will open the text editor you have configured with the key core.editor

pick cafecafec Commit One
pick facefacef Commit Two
fixup beeffeedb fixup! Commit Two
pick facefacef Commit Three

# Rebase baseba119..beeffeed6 onto baseba119 (2 commands)
#
# Commands
# p, pick &lt;commit&gt; = use commit
# r, reword &lt;commit&gt; = use commit, but edit the commit message
# e, edit &lt;commit&gt; = use commit, but stop for amending
# s, squash &lt;commit&gt; = use commit, but meld into previous commit
# f, fixup [-C | -c] &lt;commit&gt; = like &quot;squash&quot; but keep only the previous
# commit's log message, unless -C is used, in which case
# keep only this commit's message; -c is same as -C but
# opens the editor
# x, exec &lt;command&gt; = run command (the rest of the line) using shell
# b, break = stop here (continue rebase later with 'git rebase --continue')
# d, drop &lt;commit&gt; = remove commit
# l, label &lt;label&gt; = label current HEAD with a name
# t, reset &lt;label&gt; = reset HEAD to a label
# m, merge [-C &lt;commit&gt; | -c &lt;commit&gt;] &lt;label&gt; [# &lt;oneline&gt;]
# .       create a merge commit using the original merge commit's
# .       message (or the oneline, if no original merge commit was
# .       specified); use -c &lt;commit&gt; to reword the commit message
#
# These lines can be re-ordered; they are executed from top to bottom
#
# If you remove a line here THAT COMMIT WILL BE LOST
#
# However, if you remove everything, the rebase will be aborted
</code></pre>
<p>Now, we have rewritten our git history as if our fixup changes were part of the original set of change.</p>
<pre><code class="language-shell">git log
commit fa11fa11fa11fa11fa11fa11fa11fa11fa11fa11
Author: Robert Masen &lt;r.f.masen@gmail.com&gt;
Date:   Mon Jan 29 15:09:29 2024 -0600

    Commit Three

# note: this commit hash has changed
commit ba11ba11ba11ba11ba11ba11ba11ba11ba11ba11
Author: Robert Masen &lt;r.f.masen@gmail.com&gt;
Date:   Mon Jan 29 09:44:37 2024 -0600

    Commit Two

commit cafecafecafecafecafecafecafecafecafecafe
Author: Robert Masen &lt;r.f.masen@gmail.com&gt;
Date:   Fri Jan 26 15:09:01 2024 -0600

    Commit One
</code></pre>
<p>I personally have this script in my path named git-fixup</p>
<pre><code class="language-sh"># ! /bin/bash
# ~/.local/bin/git-fixup
# this can be used via `git fixup &lt;commit-hash&gt;`
git commit --fixup $1 &amp;&amp; git rebase -i --autosquash $1~1
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="manual-rebase"><a class="header" href="#manual-rebase">Manual Rebase</a></h1>
<p>Sometimes when attempting to rebase a complicated set of changes, or maybe when switching base
branches it can become very difficult to pull apart the changes. It may be tempting to perform
<code>git merge &lt;target-base&gt;</code> to pull in all of the commits but this very difficult to unwind after the
fact. One way to deal with this is to perform a &quot;manual rebase&quot;.</p>
<p>To start we need to get the list of commits we are looking to rebase, this will assume our target branch is named develop</p>
<pre><code class="language-shell">git log --pretty=oneline develop..HEAD &gt; cherry-picks
</code></pre>
<p>This will add a line to the file ./cherry-picks for each commit that appears in develop but not HEAD. Note: you may need to remove entries from this list especially if you are changing the base branch.</p>
<pre><code class="language-shell"># ./cherry-picks
ca5eca5eca5eca5eca5eca5eca5eca5eca5eca5e (HEAD -&gt; work-branch) Commit Three
7ac07ac07ac07ac07ac07ac07ac07ac07ac07ac0 Commit Two
babebabebabebabebabebabebabebabebabebabe Commit One
</code></pre>
<p>Now we can create a temporary branch to keep these commits around and then reset our branch</p>
<pre><code class="language-shell">git checkout -b tmp/work-branch
git checkout -
git reset --hard origin/develop
</code></pre>
<p>This will remove all of your changes on your work branch and reset the state to match exactly our target branch. Now we can cherry-pick our commits on top of the base.</p>
<pre><code class="language-shell">git cherry-pick babebabeb
git cherry-pick 7ac07ac07
git cherry-pick ca5eca5ec
</code></pre>
<p>In the event that any of these commits have conflicts, you'll need to deal with the merge conflict and use git cherry-pick --continue before moving on to the next commit.</p>
<p>This has essentially performed the work that rebase is supposed to do but manually.</p>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
            </nav>

        </div>

        <script type="text/javascript">
            window.playground_copyable = true;
        </script>
        <script src="elasticlunr.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="mark.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="searcher.js" type="text/javascript" charset="utf-8"></script>
        <script src="clipboard.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="highlight.js" type="text/javascript" charset="utf-8"></script>
        <script src="book.js" type="text/javascript" charset="utf-8"></script>

        <!-- Custom JS scripts -->
        <script type="text/javascript">
        window.addEventListener('load', function() {
            window.setTimeout(window.print, 100);
        });
        </script>
    </body>
</html>
